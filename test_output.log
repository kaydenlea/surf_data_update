2025-10-19 14:07:42,700 - INFO - STEP 2: Fetching beach data
2025-10-19 14:07:43,588 - INFO - HTTP Request: GET https://wborkytqlmkcgwzhsoiz.supabase.co/rest/v1/beaches?select=id%2CName%2CLATITUDE%2CLONGITUDE&offset=0&limit=1000 "HTTP/2 206 Partial Content"
2025-10-19 14:07:43,596 - INFO -    Fetched 1000 beaches (batch 1)
2025-10-19 14:07:43,696 - INFO - HTTP Request: GET https://wborkytqlmkcgwzhsoiz.supabase.co/rest/v1/beaches?select=id%2CName%2CLATITUDE%2CLONGITUDE&offset=1000&limit=1000 "HTTP/2 206 Partial Content"
2025-10-19 14:07:43,698 - INFO -    Fetched 336 beaches (batch 2)
2025-10-19 14:07:43,699 - INFO - OK: Found 1336 beaches with valid coordinates
2025-10-19 14:07:43,699 - INFO - Post-fill: starting neighbor backfill for ALL records (cadence=H, fallback=6)
2025-10-19 14:07:43,887 - INFO - HTTP Request: GET https://wborkytqlmkcgwzhsoiz.supabase.co/rest/v1/forecast_data?select=id%2Cbeach_id%2Ctimestamp%2Cweather%2Cwind_direction_deg%2Csecondary_swell_height_ft%2Csecondary_swell_period_s%2Csecondary_swell_direction%2Ctertiary_swell_height_ft%2Ctertiary_swell_period_s%2Ctertiary_swell_direction&timestamp=gte.1970-01-01T00%3A00%3A00&order=timestamp.asc%2Cbeach_id.asc&offset=0&limit=1000 "HTTP/2 200 OK"
2025-10-19 14:07:44,134 - INFO - HTTP Request: GET https://wborkytqlmkcgwzhsoiz.supabase.co/rest/v1/forecast_data?select=id%2Cbeach_id%2Ctimestamp%2Cweather%2Cwind_direction_deg%2Csecondary_swell_height_ft%2Csecondary_swell_period_s%2Csecondary_swell_direction%2Ctertiary_swell_height_ft%2Ctertiary_swell_period_s%2Ctertiary_swell_direction&timestamp=gte.1970-01-01T00%3A00%3A00&order=timestamp.asc%2Cbeach_id.asc&offset=1000&limit=1000 "HTTP/2 200 OK"
2025-10-19 14:07:44,352 - INFO - HTTP Request: GET https://wborkytqlmkcgwzhsoiz.supabase.co/rest/v1/forecast_data?select=id%2Cbeach_id%2Ctimestamp%2Cweather%2Cwind_direction_deg%2Csecondary_swell_height_ft%2Csecondary_swell_period_s%2Csecondary_swell_direction%2Ctertiary_swell_height_ft%2Ctertiary_swell_period_s%2Ctertiary_swell_direction&timestamp=gte.1970-01-01T00%3A00%3A00&order=timestamp.asc%2Cbeach_id.asc&offset=2000&limit=1000 "HTTP/2 200 OK"
2025-10-19 14:07:44,497 - INFO - HTTP Request: GET https://wborkytqlmkcgwzhsoiz.supabase.co/rest/v1/forecast_data?select=id%2Cbeach_id%2Ctimestamp%2Cweather%2Cwind_direction_deg%2Csecondary_swell_height_ft%2Csecondary_swell_period_s%2Csecondary_swell_direction%2Ctertiary_swell_height_ft%2Ctertiary_swell_period_s%2Ctertiary_swell_direction&timestamp=gte.1970-01-01T00%3A00%3A00&order=timestamp.asc%2Cbeach_id.asc&offset=3000&limit=1000 "HTTP/2 200 OK"
2025-10-19 14:07:44,694 - INFO - HTTP Request: GET https://wborkytqlmkcgwzhsoiz.supabase.co/rest/v1/forecast_data?select=id%2Cbeach_id%2Ctimestamp%2Cweather%2Cwind_direction_deg%2Csecondary_swell_height_ft%2Csecondary_swell_period_s%2Csecondary_swell_direction%2Ctertiary_swell_height_ft%2Ctertiary_swell_period_s%2Ctertiary_swell_direction&timestamp=gte.1970-01-01T00%3A00%3A00&order=timestamp.asc%2Cbeach_id.asc&offset=4000&limit=1000 "HTTP/2 200 OK"
2025-10-19 14:07:44,711 - INFO - Post-fill: evaluating 5000 forecast rows
E:\Code\surf_data_update\fill_neighbors.py:98: FutureWarning: 'H' is deprecated and will be removed in a future version, please use 'h' instead.
  ts = ts.floor(freq)
2025-10-19 14:07:49,850 - INFO - Post-fill: 5000 records | buckets=4 | skipped bad_ts=0 no_coords=0
2025-10-19 14:07:49,850 - INFO - Post-fill: field fills -> weather: 1172, wind_direction_deg: 216, secondary_swell_height_ft: 928, secondary_swell_period_s: 806, tertiary_swell_height_ft: 261, tertiary_swell_period_s: 216, tertiary_swell_direction: 216
2025-10-19 14:07:49,850 - INFO - Dry-run: skipping DB writes (1720 rows)
2025-10-19 14:07:49,851 - INFO - Post-fill: completed neighbor backfill
